"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var express = require("express");
var linetwork = require("linetwork");
;
module.exports = (function (_super) {
    __extends(NetManager, _super);
    function NetManager(conf) {
        _super.call(this, conf);
    }
    NetManager.prototype.Router = function () {
        var NetManager = this;
        var Router = express.Router();
        Router.get('/connect/:recovery', function (req, res) {
            NetManager.connection(req.params.recovery).then(function () {
                res.send({ ok: true });
            }).catch(function () {
                res.send({ ok: false });
            });
        });
        Router.get('/list', function (req, res) {
            NetManager.networks().then(function (n) {
                res.send(n);
            }).then(function (err) {
                res.send(err);
            });
        });
        Router.get('/mobile/providers', function (req, res) {
            res.send(NetManager.mobileproviders());
        });
        Router.get('/mobile/providers/country/:country', function (req, res) {
            var providers = NetManager.mobileproviders();
            res.send(providers.country(req.params.country));
        });
        Router.get('/recovery', function (req, res) {
            NetManager.recovery().then(function () {
                res.send({ ok: true });
            }).catch(function () {
                res.send({ ok: false });
            });
        });
        Router.post('/configuration', function (req, res) {
            console.log('Manager home page');
        });
        Router.get('/wifi/wpa', function (req, res) {
            var wpamanager = NetManager.wpamanager();
            res.send(wpamanager.listwpa);
        });
        Router.post('/wifi/wpa/add', function (req, res) {
            var wpamanager = NetManager.wpamanager();
            wpamanager.addwpa(req.params.ssid, req.params.password, req.params.priority).then(function () {
                res.send({ ok: true });
            }).catch(function () {
                res.send({ ok: false });
            });
        });
        Router.post('/wifi/wpa/remove/:ssid', function (req, res) {
            var wpamanager = NetManager.wpamanager();
            wpamanager.removewpa(req.params.ssid).then(function () {
                res.send({ ok: true });
            }).catch(function () {
                res.send({ ok: false });
            });
        });
        return Router;
    };
    return NetManager;
}(linetwork));

//# sourceMappingURL=data:application/json;base64,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RlIsQ0F0RmlDLFNBQVMsRUFzRjFDLENBQUEiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgbGluZXR3b3JrID0gcmVxdWlyZShcImxpbmV0d29ya1wiKTtcblxuaW50ZXJmYWNlIElQcm92aWRlciB7XG5cbiAgICBsYWJlbD86IHN0cmluZztcbiAgICBhcG46IHN0cmluZztcbiAgICBwaG9uZT86IHN0cmluZ1xuICAgIHVzZXJuYW1lPzogc3RyaW5nO1xuICAgIHBhc3N3b3JkPzogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJTW9iaWxlIHtcbiAgICBwcm92aWRlcjogSVByb3ZpZGVyO1xuICAgIGRldmljZT86IGFueTtcbiAgICBjb25maWdGaWxlUGF0aD86IHN0cmluZztcbn1cbmludGVyZmFjZSBJSG9zdGFwZGNmIHtcbiAgICBkcml2ZXI/OiBzdHJpbmc7XG4gICAgc3NpZDogc3RyaW5nO1xuICAgIHdwYV9wYXNzcGhyYXNlOiBhbnk7XG59O1xuaW50ZXJmYWNlIENsYXNzT3B0IHtcbiAgICB3aWZpX2ludGVyZmFjZT86IHN0cmluZztcbiAgICBtb2JpbGU/OiBJTW9iaWxlO1xuICAgIGhvc3RhcGQ/OiBJSG9zdGFwZGNmO1xuICAgIHdwYXN1cHBsaWNhbnRfcGF0aD86IHN0cmluZztcbn1cblxuZXhwb3J0ID0gY2xhc3MgTmV0TWFuYWdlciBleHRlbmRzIGxpbmV0d29yayB7XG4gICAgTmV0TWFuYWdlcjtcbiAgICBjb25zdHJ1Y3Rvcihjb25mOiBDbGFzc09wdCkge1xuICAgICAgICBzdXBlcihjb25mKTtcblxuICAgIH1cblxuXG4gICAgUm91dGVyKCkge1xuICAgICAgICBsZXQgTmV0TWFuYWdlciA9IHRoaXM7XG4gICAgICAgIGxldCBSb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIC8vIGRlZmluZSB0aGUgaG9tZSBwYWdlIHJvdXRlXG5cbiAgICAgICAgXG4gICAgICAgIFJvdXRlci5nZXQoJy9jb25uZWN0LzpyZWNvdmVyeScsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gICAgICAgICAgICBOZXRNYW5hZ2VyLmNvbm5lY3Rpb24ocmVxLnBhcmFtcy5yZWNvdmVyeSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXMuc2VuZCh7IG9rOiB0cnVlIH0pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNlbmQoeyBvazogZmFsc2UgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgUm91dGVyLmdldCgnL2xpc3QnLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICAgICAgICAgICAgTmV0TWFuYWdlci5uZXR3b3JrcygpLnRoZW4oZnVuY3Rpb24obikge1xuICAgICAgICAgICAgICAgIHJlcy5zZW5kKG4pO1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZXMuc2VuZChlcnIpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICB9KTtcblxuXG5cblxuICAgICAgICBSb3V0ZXIuZ2V0KCcvbW9iaWxlL3Byb3ZpZGVycycsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gICAgICAgICAgICByZXMuc2VuZChOZXRNYW5hZ2VyLm1vYmlsZXByb3ZpZGVycygpKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgUm91dGVyLmdldCgnL21vYmlsZS9wcm92aWRlcnMvY291bnRyeS86Y291bnRyeScsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gICAgICAgICAgICBsZXQgcHJvdmlkZXJzID0gTmV0TWFuYWdlci5tb2JpbGVwcm92aWRlcnMoKTtcbiAgICAgICAgICAgIHJlcy5zZW5kKHByb3ZpZGVycy5jb3VudHJ5KHJlcS5wYXJhbXMuY291bnRyeSkpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBSb3V0ZXIuZ2V0KCcvcmVjb3ZlcnknLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICAgICAgICAgICAgTmV0TWFuYWdlci5yZWNvdmVyeSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNlbmQoeyBvazogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgb2s6IGZhbHNlIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIFJvdXRlci5wb3N0KCcvY29uZmlndXJhdGlvbicsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTWFuYWdlciBob21lIHBhZ2UnKTtcblxuICAgICAgICB9KTtcblxuICAgICAgICBSb3V0ZXIuZ2V0KCcvd2lmaS93cGEnLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICAgICAgICAgICAgbGV0IHdwYW1hbmFnZXIgPSBOZXRNYW5hZ2VyLndwYW1hbmFnZXIoKTtcbiAgICAgICAgICAgIHJlcy5zZW5kKHdwYW1hbmFnZXIubGlzdHdwYSk7XG5cblxuICAgICAgICB9KTtcbiAgICAgICAgUm91dGVyLnBvc3QoJy93aWZpL3dwYS9hZGQnLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICAgICAgICAgICAgbGV0IHdwYW1hbmFnZXIgPSBOZXRNYW5hZ2VyLndwYW1hbmFnZXIoKTtcbiAgICAgICAgICAgIHdwYW1hbmFnZXIuYWRkd3BhKHJlcS5wYXJhbXMuc3NpZCwgcmVxLnBhcmFtcy5wYXNzd29yZCwgcmVxLnBhcmFtcy5wcmlvcml0eSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXMuc2VuZCh7IG9rOiB0cnVlIH0pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNlbmQoeyBvazogZmFsc2UgfSk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH0pO1xuICAgICAgICBSb3V0ZXIucG9zdCgnL3dpZmkvd3BhL3JlbW92ZS86c3NpZCcsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gICAgICAgICAgICBsZXQgd3BhbWFuYWdlciA9IE5ldE1hbmFnZXIud3BhbWFuYWdlcigpO1xuICAgICAgICAgICAgd3BhbWFuYWdlci5yZW1vdmV3cGEocmVxLnBhcmFtcy5zc2lkKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgb2s6IHRydWUgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXMuc2VuZCh7IG9rOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIFJvdXRlcjtcbiAgICB9XG5cbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
